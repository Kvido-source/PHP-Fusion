/*! SearchPanes 1.0.1
 * 2019-2020 SpryMedia Ltd - datatables.net/license
 */
(function(){var c=$.fn.dataTable;var a=(function(){function e(o,f,p,k,g,m){var l=this;if(m===void 0){m=null}if(!c||!c.versionCheck||!c.versionCheck("1.10.0")){throw new Error("SearchPane requires DataTables 1.10 or newer")}if(!c.select){throw new Error("SearchPane requires Select")}var q=new c.Api(o);this.classes=$.extend(true,{},e.classes);this.c=$.extend(true,{},e.defaults,f);this.customPaneSettings=m;this.s={cascadeRegen:false,clearing:false,colOpts:[],deselect:false,displayed:false,dt:q,dtPane:undefined,filteringActive:false,index:p,indexes:[],lastSelect:false,redraw:false,rowData:{arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map()},searchFunction:undefined,selectPresent:false,updating:false};var h=q.columns().eq(0).toArray().length;this.colExists=this.s.index<h;this.c.layout=k;var i=parseInt(k.split("-")[1],10);this.dom={buttonGroup:$("<div/>").addClass(this.classes.buttonGroup),clear:$('<button type="button">&#215;</button>').addClass(this.classes.dull).addClass(this.classes.paneButton).addClass(this.classes.clearButton),container:$("<div/>").addClass(this.classes.container).addClass(this.classes.layout+(i<7?k:k.split("-")[0]+"-6")),countButton:$('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.countButton),dtP:$("<table><thead><tr><th>"+(this.colExists?$(q.column(this.colExists?this.s.index:0).header()).text():this.customPaneSettings.header||"Custom Pane")+"</th><th/></tr></thead></table>"),lower:$("<div/>").addClass(this.classes.subRow2).addClass(this.classes.narrowButton),nameButton:$('<button type="button"></button>').addClass(this.classes.paneButton).addClass(this.classes.nameButton),searchBox:$("<input/>").addClass(this.classes.paneInputButton).addClass(this.classes.search),searchButton:$('<button type = "button" class="'+this.classes.searchIcon+'"></button>').addClass(this.classes.paneButton),searchCont:$("<div/>").addClass(this.classes.searchCont),searchLabelCont:$("<div/>").addClass(this.classes.searchLabelCont),topRow:$("<div/>").addClass(this.classes.topRow),upper:$("<div/>").addClass(this.classes.subRow1).addClass(this.classes.narrowSearch)};this.s.displayed=false;q=this.s.dt;this.selections=[];this.s.colOpts=this.colExists?this._getOptions():this._getBonusOptions();var n=this.s.colOpts;var j=$('<button type="button">X</button>').addClass(this.classes.paneButton);$(j).text(q.i18n("searchPanes.clearPane","X"));this.dom.container.addClass(n.className);this.dom.container.addClass((this.customPaneSettings!==null&&this.customPaneSettings.className!==undefined)?this.customPaneSettings.className:"");$(g).append(this.dom.container);var r=q.table(0).node();this.s.searchFunction=function(v,u,s,w){if(l.selections.length===0){return true}if(v.nTable!==r){return true}var t="";if(l.colExists){t=u[l.s.index];if(n.orthogonal.filter!=="filter"){t=l.s.rowData.filterMap.get(s);if(t instanceof $.fn.dataTable.Api){t=t.toArray()}}}return l._search(t,s)};$.fn.dataTable.ext.search.push(this.s.searchFunction);if(this.c.clear){$(j).on("click",function(){var s=l.dom.container.find(l.classes.search);s.each(function(){$(this).val("");$(this).trigger("input")});l.clearPane()})}q.on("draw.dtsp",function(){l._adjustTopRow()});$(window).on("resize.dtsp",c.util.throttle(function(){l._adjustTopRow()}));q.on("column-reorder.dtsp",function(u,t,s){l.s.index=s.mapping[l.s.index]});return this}e.prototype.clearData=function(){this.s.rowData={arrayFilter:[],arrayOriginal:[],arrayTotals:[],bins:{},binsOriginal:{},binsTotal:{},filterMap:new Map()}};e.prototype.clearPane=function(){this.s.dtPane.rows({selected:true}).deselect();this.updateTable();return this};e.prototype.destroy=function(){$(this.s.dtPane).off(".dtsp");$(this.s.dt).off(".dtsp");$(this.dom.nameButton).off(".dtsp");$(this.dom.countButton).off(".dtsp");$(this.dom.clear).off(".dtsp");$(this.dom.searchButton).off(".dtsp");$(this.dom.container).remove();var f=$.fn.dataTable.ext.search.indexOf(this.s.searchFunction);while(f!==-1){$.fn.dataTable.ext.search.splice(f,1);f=$.fn.dataTable.ext.search.indexOf(this.s.searchFunction)}if(this.s.dtPane!==undefined){this.s.dtPane.destroy()}};e.prototype.getPaneCount=function(){return this.s.dtPane!==undefined?this.s.dtPane.rows({selected:true}).data().toArray().length:0};e.prototype.rebuildPane=function(){this.clearData();if(this.s.dtPane!==undefined){this.s.dtPane.clear().destroy()}this.dom.container.removeClass(this.classes.hidden);this.s.displayed=false;this._buildPane();return this};e.prototype.removePane=function(){this.s.displayed=false;$(this.dom.container).hide()};e.prototype.setCascadeRegen=function(f){this.s.cascadeRegen=f};e.prototype.setClear=function(f){this.s.clearing=f};e.prototype.updatePane=function(f){if(f===void 0){f=false}this.s.updating=true;this._updateCommon(f);this.s.updating=false};e.prototype.updateTable=function(){var f=this.s.dtPane.rows({selected:true}).data().toArray();this.selections=f;this._searchExtras();if(this.c.cascadePanes||this.c.viewTotal){this.updatePane()}};e.prototype._addOption=function(j,l,g,h,m,k){if(Array.isArray(j)||j instanceof c.Api){if(j instanceof c.Api){j=j.toArray();l=l.toArray()}if(j.length===l.length){for(var f=0;f<j.length;f++){if(!k[j[f]]){k[j[f]]=1;m.push({display:l[f],filter:j[f],sort:g,type:h})}else{k[j[f]]++}}return}else{throw new Error("display and filter not the same length")}}else{if(typeof this.s.colOpts.orthogonal==="string"){if(!k[j]){k[j]=1;m.push({display:l,filter:j,sort:g,type:h})}else{k[j]++;return}}else{m.push({display:l,filter:j,sort:g,type:h})}}};e.prototype._addRow=function(j,f,o,m,h,k){var i;for(var g=0,l=this.s.indexes;g<l.length;g++){var n=l[g];if(n.filter===f){i=n.index}}if(i===undefined){i=this.s.indexes.length;this.s.indexes.push({filter:f,index:i})}return this.s.dtPane.row.add({display:j!==""?j:this.c.emptyMessage,filter:f,index:i,shown:o,sort:h!==""?h:this.c.emptyMessage,total:m,type:k})};e.prototype._adjustTopRow=function(){var g=this.dom.container.find("."+this.classes.subRowsContainer);var f=this.dom.container.find(".dtsp-subRow1");var i=this.dom.container.find(".dtsp-subRow2");var h=this.dom.container.find("."+this.classes.topRow);if(($(g[0]).width()<252||$(h[0]).width()<252)&&$(g[0]).width()!==0){$(g[0]).addClass(this.classes.narrow);$(f[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowSearch);$(i[0]).addClass(this.classes.narrowSub).removeClass(this.classes.narrowButton)}else{$(g[0]).removeClass(this.classes.narrow);$(f[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowSearch);$(i[0]).removeClass(this.classes.narrowSub).addClass(this.classes.narrowButton)}};e.prototype._buildPane=function(){var w=this;this.selections=[];var A=this.s.dt;var m=A.column(this.colExists?this.s.index:0);var l=this.s.colOpts;var q=this.s.rowData;var g=A.i18n("searchPanes.count","{total}");var B=A.i18n("searchPanes.countFiltered","{shown} ({total})");var f=A.state.loaded();if(this.colExists){var t=-1;if(f&&f.searchPanes&&f.searchPanes.panes){for(var y=0;y<f.searchPanes.panes.length;y++){if(f.searchPanes.panes[y].id===this.s.index){t=y;break}}}if((l.show===false||(l.show!==undefined&&l.show!==true))&&t===-1){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return false}else{if(l.show===true||t!==-1){this.s.displayed=true}}if(q.arrayFilter.length===0){this._populatePane();if(f&&f.searchPanes&&f.searchPanes.panes){if(t!==-1){q.binsOriginal=f.searchPanes.panes[t].bins;q.arrayOriginal=f.searchPanes.panes[t].arrayFilter}else{this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return}}else{q.arrayOriginal=q.arrayFilter;q.binsOriginal=q.bins}}var h=Object.keys(q.binsOriginal).length;var n=this._uniqueRatio(h,A.rows()[0].length);if(this.s.displayed===false&&((l.show===undefined&&l.threshold===null?n>this.c.threshold:n>l.threshold)||(l.show!==true&&h<=1))){this.dom.container.addClass(this.classes.hidden);this.s.displayed=false;return}if(this.c.viewTotal&&q.arrayTotals.length===0){this._detailsPane()}else{q.binsTotal=q.bins}this.dom.container.addClass(this.classes.show);this.s.displayed=true}else{this.s.displayed=true}this._displayPane();this.dom.dtP.on("stateLoadParams.dt",function(D,i,C){if($.isEmptyObject(A.state.loaded())){$.each(C,function(E,F){delete C[E]})}});var u=$.fn.dataTable.ext.errMode;$.fn.dataTable.ext.errMode="none";var z=c.Scroller;this.s.dtPane=$(this.dom.dtP).DataTable($.extend(true,{dom:"t",columnDefs:[{className:"dtsp-nameColumn",data:"display",render:function(F,D,G){if(D==="sort"){return G.sort}else{if(D==="type"){return G.type}}var E;w.s.filteringActive&&w.c.viewTotal?E=B.replace(/{total}/,G.total):E=g.replace(/{total}/,G.total);E=E.replace(/{shown}/,G.shown);while(E.indexOf("{total}")!==-1){E=E.replace(/{total}/,G.total)}while(E.indexOf("{shown}")!==-1){E=E.replace(/{shown}/,G.shown)}var C="";var i='<span class="'+w.classes.pill+'">'+E+"</span>";if(w.c.hideCount||l.hideCount){i=""}if(!w.c.dataLength){C='<span class="'+w.classes.name+'">'+F+"</span>"+i}else{if(F.length>w.c.dataLength){C='<span class="'+w.classes.name+'">'+F.substr(0,w.c.dataLength)+"...</span>"+i}else{C='<span class="'+w.classes.name+'">'+F+"</span>"+i}}return C},targets:0,type:A.settings()[0].aoColumns[this.s.index]!==undefined?A.settings()[0].aoColumns[this.s.index]._sManualType:null},{className:"dtsp-countColumn "+this.classes.badgePill,data:"total",targets:1,visible:false}],deferRender:true,info:false,paging:z?true:false,scrollY:"200px",scroller:z?true:false,select:true,stateSave:A.settings()[0].oFeatures.bStateSave?true:false},this.c.dtOpts,l!==undefined?l.dtOpts:{},(this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined)?this.customPaneSettings.dtOpts:{}));$(this.dom.dtP).addClass(this.classes.table);$(this.dom.searchBox).attr("placeholder",l.header!==undefined?l.header:this.colExists?A.settings()[0].aoColumns[this.s.index].sTitle:this.customPaneSettings.header||"Custom Pane");$.fn.dataTable.select.init(this.s.dtPane);$.fn.dataTable.ext.errMode=u;if(this.colExists){var r=m.search();r=r?r.substr(1,r.length-2).split("|"):[];var x=0;q.arrayFilter.forEach(function(i){if(i.filter===""){x++}});for(var y=0,k=q.arrayFilter.length;y<k;y++){if(q.arrayFilter[y]&&(q.bins[q.arrayFilter[y].filter]!==undefined||!this.c.cascadePanes)){var p=this._addRow(q.arrayFilter[y].display,q.arrayFilter[y].filter,q.bins[q.arrayFilter[y].filter],q.binsTotal[q.arrayFilter[y].filter],q.arrayFilter[y].sort,q.arrayFilter[y].type);if(l.preSelect!==undefined&&l.preSelect.indexOf(q.arrayFilter[y].filter)!==-1){p.select()}}else{this._addRow(this.c.emptyMessage,x,x,this.c.emptyMessage,this.c.emptyMessage,this.c.emptyMessage)}}}if(l.options!==undefined||(this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined)){this._getComparisonRows()}c.select.init(this.s.dtPane);this.s.dtPane.draw();this.s.dtPane.on("select.dtsp",function(){clearTimeout(s);$(w.dom.clear).removeClass(w.classes.dull);w.s.selectPresent=true;if(!w.s.updating){w._makeSelection()}w.s.selectPresent=false});this.s.dt.on("stateSaveParams.dtsp",function(H,E,G){if($.isEmptyObject(G)){w.s.dtPane.state.clear();return}var D=[];var C;var i;var F;var I;if(w.s.dtPane!==undefined){D=w.s.dtPane.rows({selected:true}).data().map(function(J){return J.filter.toString()}).toArray();C=$(w.dom.searchBox).val();i=w.s.dtPane.order();F=q.binsOriginal;I=q.arrayOriginal}if(G.searchPanes===undefined){G.searchPanes={}}if(G.searchPanes.panes===undefined){G.searchPanes.panes=[]}G.searchPanes.panes.push({arrayFilter:I,bins:F,id:w.s.index,order:i,searchTerm:C,selected:D})});if(f&&f.searchPanes&&f.searchPanes.panes){if(!this.c.cascadePanes){this._reloadSelect(f)}for(var j=0,o=f.searchPanes.panes;j<o.length;j++){var v=o[j];if(v.id===this.s.index){$(this.dom.searchBox).val(v.searchTerm);this.s.dt.order(v.order)}}}this.s.dtPane.on("user-select.dtsp",function(F,D,E,C,i){i.stopPropagation()});$(this.dom.nameButton).on("click.dtsp",function(){var i=w.s.dtPane.order()[0][1];w.s.dtPane.order([0,i==="asc"?"desc":"asc"]).draw()});$(this.dom.countButton).on("click.dtsp",function(){var i=w.s.dtPane.order()[0][1];w.s.dtPane.order([1,i==="asc"?"desc":"asc"]).draw()});$(this.dom.clear).on("click.dtsp",function(){var i=w.dom.container.find("."+w.classes.search);i.each(function(){$(this).val("");$(this).trigger("input")});w.clearPane()});$(this.dom.searchButton).on("click.dtsp",function(){$(w.dom.searchBox).focus()});$(this.dom.searchBox).on("input.dtsp",function(){w.s.dtPane.search($(w.dom.searchBox).val()).draw();w.s.dt.state.save()});var s;this.s.dtPane.on("deselect.dtsp",function(){s=setTimeout(function(){w.s.deselect=true;if(w.s.dtPane.rows({selected:true}).data().toArray().length===0){$(w.dom.clear).addClass(w.classes.dull)}w._makeSelection();w.s.deselect=false;w.s.dt.state.save()},50)});this.s.dt.state.save();return true};e.prototype._detailsPane=function(){var h=this;var g=this.s.dt;this.s.rowData.arrayTotals=[];this.s.rowData.binsTotal={};var f=this.s.dt.settings()[0];g.rows().every(function(i){h._populatePaneArray(i,h.s.rowData.arrayTotals,f,h.s.rowData.binsTotal)})};e.prototype._displayPane=function(){var f=this.dom.container;var h=this.s.colOpts;var g=parseInt(this.c.layout.split("-")[1],10);$(this.dom.topRow).empty();$(this.dom.dtP).empty();$(this.dom.topRow).addClass(this.classes.topRow);if(g>3){$(this.dom.container).addClass(this.classes.smallGap)}$(this.dom.topRow).addClass(this.classes.subRowsContainer);$(this.dom.upper).appendTo(this.dom.topRow);$(this.dom.lower).appendTo(this.dom.topRow);$(this.dom.searchCont).appendTo(this.dom.upper);$(this.dom.buttonGroup).appendTo(this.dom.lower);if(this.c.dtOpts.searching===false||(h.dtOpts!==undefined&&h.dtOpts.searching===false)||(!this.c.controls||!h.controls)||(this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined&&this.customPaneSettings.dtOpts.searching!==undefined&&!this.customPaneSettings.dtOpts.searching)){$(this.dom.searchBox).attr("disabled","disabled").removeClass(this.classes.paneInputButton).addClass(this.classes.disabledButton)}$(this.dom.searchBox).appendTo(this.dom.searchCont);this._searchContSetup();if(this.c.clear&&this.c.controls&&h.controls){$(this.dom.clear).appendTo(this.dom.buttonGroup)}if(this.c.orderable&&h.orderable&&this.c.controls&&h.controls){$(this.dom.nameButton).appendTo(this.dom.buttonGroup)}if(!this.c.hideCount&&!h.hideCount&&this.c.orderable&&h.orderable&&this.c.controls&&h.controls){$(this.dom.countButton).appendTo(this.dom.buttonGroup)}$(this.dom.topRow).prependTo(this.dom.container);$(f).append(this.dom.dtP);$(f).show()};e.prototype._findUnique=function(i,k){var g=[];for(var h=0,f=k;h<f.length;h++){var j=f[h];if(g.indexOf(j.filter)===-1){i.push({display:j.display,filter:j.filter,sort:j.sort,type:j.type});g.push(j.filter)}}};e.prototype._getBonusOptions=function(){var f={orthogonal:{threshold:null},threshold:null};return $.extend(true,{},e.defaults,f,this.c!==undefined?this.c:{})};e.prototype._getComparisonRows=function(){var o=this.s.colOpts;var t=o.options!==undefined?o.options:this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined?this.customPaneSettings.options:undefined;if(t===undefined){return}var k=this.s.dt.rows({search:"applied"}).data().toArray();var m=this.s.dt.rows({search:"applied"});var p=this.s.dt.rows().data().toArray();var n=this.s.dt.rows();var s=[];this.s.dtPane.clear();for(var f=0,j=t;f<j.length;f++){var l=j[f];var q=l.label!==""?l.label:this.c.emptyMessage;var h={display:q,filter:typeof l.value==="function"?l.value:[],shown:0,sort:q,total:0,type:q};if(typeof l.value==="function"){for(var r=0;r<k.length;r++){if(l.value.call(this.s.dt,k[r],m[0][r])){h.shown++}}for(var g=0;g<p.length;g++){if(l.value.call(this.s.dt,p[g],n[0][g])){h.total++}}if(typeof h.filter!=="function"){h.filter.push(l.filter)}}if(!this.c.cascadePanes||(this.c.cascadePanes&&h.shown!==0)){s.push(this._addRow(h.display,h.filter,h.shown,h.total,h.sort,h.type))}}return s};e.prototype._getOptions=function(){var f=this.s.dt;var g={orthogonal:{threshold:null},threshold:null};return $.extend(true,{},e.defaults,g,f.settings()[0].aoColumns[this.s.index].searchPanes)};e.prototype._makeSelection=function(){this.updateTable();this.s.updating=true;this.s.dt.draw();this.s.updating=false};e.prototype._populatePane=function(){var j=this.s.dt;this.s.rowData.arrayFilter=[];this.s.rowData.bins={};var h=this.s.dt.settings()[0];var g=(this.c.cascadePanes||this.c.viewTotal)&&!this.s.clearing?j.rows({search:"applied"}).indexes():j.rows().indexes();for(var k=0,i=g;k<i.length;k++){var f=i[k];this._populatePaneArray(f,this.s.rowData.arrayFilter,h)}};e.prototype._populatePaneArray=function(i,k,g,h){if(h===void 0){h=this.s.rowData.bins}var j=this.s.colOpts;if(typeof j.orthogonal==="string"){var l=g.oApi._fnGetCellData(g,i,this.s.index,j.orthogonal);this.s.rowData.filterMap.set(i,l);this._addOption(l,l,l,l,k,h)}else{var f=g.oApi._fnGetCellData(g,i,this.s.index,j.orthogonal.search);this.s.rowData.filterMap.set(i,f);if(!h[f]){h[f]=1;this._addOption(f,g.oApi._fnGetCellData(g,i,this.s.index,j.orthogonal.display),g.oApi._fnGetCellData(g,i,this.s.index,j.orthogonal.sort),g.oApi._fnGetCellData(g,i,this.s.index,j.orthogonal.type),k,h)}else{h[f]++;return}}};e.prototype._reloadSelect=function(n){if(n===undefined){return}var l;for(var j=0;j<n.searchPanes.panes.length;j++){if(n.searchPanes.panes[j].id===this.s.index){l=j;break}}if(l!==undefined){var m=this.s.dtPane;var o=m.rows({order:"index"}).data().map(function(i){return i.filter!==null?i.filter.toString():null}).toArray();for(var h=0,k=n.searchPanes.panes[l].selected;h<k.length;h++){var g=k[h];var f=-1;if(g!==null){f=o.indexOf(g.toString())}if(f>-1){m.row(f).select();this.s.dt.state.save()}}}};e.prototype._search=function(h,g){var l=this.s.colOpts;var i=this.s.dt;for(var k=0,f=this.selections;k<f.length;k++){var j=f[k];if(Array.isArray(h)){if(h.indexOf(j.filter)!==-1){return true}}else{if(typeof j.filter==="function"){if(j.filter.call(i,i.row(g).data(),g)){if(!this.s.redraw){this.updatePane()}if(l.combiner==="or"){return true}}else{if(l.combiner==="and"){return false}}}else{if(h===j.filter){return true}}}}if(l.combiner==="and"){return true}else{return false}};e.prototype._searchContSetup=function(){if(this.c.controls&&this.s.colOpts.controls){$(this.dom.searchButton).appendTo(this.dom.searchLabelCont)}if(!(this.c.dtOpts.searching===false||this.s.colOpts.dtOpts.searching===false||(this.customPaneSettings!==null&&this.customPaneSettings.dtOpts!==undefined&&this.customPaneSettings.dtOpts.searching!==undefined&&!this.customPaneSettings.dtOpts.searching))){$(this.dom.searchLabelCont).appendTo(this.dom.searchCont)}};e.prototype._searchExtras=function(){var h=this.s.updating;this.s.updating=true;var i=this.s.dtPane.rows({selected:true}).data().pluck("filter").toArray();var g=i.indexOf(this.c.emptyMessage);var f=$(this.s.dtPane.table().container());if(g>-1){i[g]=""}if(i.length>0){f.addClass(this.classes.selected)}else{if(i.length===0){f.removeClass(this.classes.selected)}}this.s.updating=h};e.prototype._uniqueRatio=function(g,f){if(f>0){return g/f}else{return 1}};e.prototype._updateCommon=function(p){if(p===void 0){p=false}if(this.s.dtPane!==undefined&&((!this.s.filteringActive||this.c.cascadePanes)||p===true)&&(this.c.cascadePanes!==true||this.s.selectPresent!==true)&&!this.s.lastSelect){var h=this.s.colOpts;var r=this.s.dtPane.rows({selected:true}).data().toArray();var f=$(this.s.dtPane.table().node()).parent()[0].scrollTop;var n=this.s.rowData;this.s.dtPane.clear();if(this.colExists){if(n.arrayFilter.length===0){this._populatePane()}else{if(this.c.cascadePanes&&this.s.dt.rows().data().toArray().length===this.s.dt.rows({search:"applied"}).data().toArray().length){n.arrayFilter=n.arrayOriginal;n.bins=n.binsOriginal}else{if(this.c.viewTotal||this.c.cascadePanes){this._populatePane()}}}if(this.c.viewTotal){this._detailsPane()}else{n.binsTotal=n.bins}if(this.c.viewTotal&&!this.c.cascadePanes){n.arrayFilter=n.arrayTotals}var v=function(y){if(y&&((n.bins[y.filter]!==undefined&&n.bins[y.filter]!==0&&w.c.cascadePanes)||!w.c.cascadePanes||w.s.clearing)){var z=w._addRow(y.display,y.filter,!w.c.viewTotal?n.bins[y.filter]:n.bins[y.filter]!==undefined?n.bins[y.filter]:0,w.c.viewTotal?String(n.binsTotal[y.filter]):n.bins[y.filter],y.sort,y.type);var x=r.findIndex(function(A){return A.filter===y.filter});if(x!==-1){z.select();r.splice(x,1)}}};var w=this;for(var g=0,l=n.arrayFilter;g<l.length;g++){var q=l[g];v(q)}}if((h.searchPanes!==undefined&&h.searchPanes.options!==undefined)||h.options!==undefined||(this.customPaneSettings!==null&&this.customPaneSettings.options!==undefined)){var o=this._getComparisonRows();var u=function(y){var x=r.findIndex(function(z){if(z.display===y.data().display){return true}});if(x!==-1){y.select();r.splice(x,1)}};for(var k=0,i=o;k<i.length;k++){var m=i[k];u(m)}}for(var j=0,t=r;j<t.length;j++){var s=t[j];var m=this._addRow(s.display,s.filter,0,this.c.viewTotal?s.total:0,s.filter,s.filter);m.select()}this.s.dtPane.draw();this.s.dtPane.table().node().parentNode.scrollTop=f}};e.version="1.0.1";e.classes={buttonGroup:"dtsp-buttonGroup",buttonSub:"dtsp-buttonSub",clear:"dtsp-clear",clearAll:"dtsp-clearAll",clearButton:"clearButton",container:"dtsp-searchPane",countButton:"dtsp-countButton",disabledButton:"dtsp-disabledButton",dull:"dtsp-dull",hidden:"dtsp-hidden",hide:"dtsp-hide",layout:"dtsp-",name:"dtsp-name",nameButton:"dtsp-nameButton",narrow:"dtsp-narrow",paneButton:"dtsp-paneButton",paneInputButton:"dtsp-paneInputButton",pill:"dtsp-pill",search:"dtsp-search",searchCont:"dtsp-searchCont",searchIcon:"dtsp-searchIcon",searchLabelCont:"dtsp-searchButtonCont",selected:"dtsp-selected",smallGap:"dtsp-smallGap",subRow1:"dtsp-subRow1",subRow2:"dtsp-subRow2",subRowsContainer:"dtsp-subRowsContainer",title:"dtsp-title",topRow:"dtsp-topRow"};e.defaults={cascadePanes:false,clear:true,combiner:"or",controls:true,container:function(f){return f.table().container()},dataLength:30,dtOpts:{},emptyMessage:"<i>No Data</i>",hideCount:false,layout:"columns-3",orderable:true,orthogonal:{display:"display",hideCount:false,search:"filter",show:undefined,sort:"sort",threshold:0.6,type:"type"},preSelect:[],threshold:0.6,viewTotal:false};return e}());var b=$.fn.dataTable;var d=(function(){function e(h,g,j){var i=this;if(j===void 0){j=false}this.regenerating=false;if(!b||!b.versionCheck||!b.versionCheck("1.10.0")){throw new Error("SearchPane requires DataTables 1.10 or newer")}if(!b.select){throw new Error("SearchPane requires Select")}var f=new b.Api(h);this.classes=$.extend(true,{},e.classes);this.c=$.extend(true,{},e.defaults,g);this.dom={clearAll:$('<button type="button">Clear All</button>').addClass(this.classes.clearAll),container:$("<div/>").addClass(this.classes.panes).text(f.i18n("searchPanes.loadMessage","Loading Search Panes...")),emptyMessage:$("<div/>").addClass(this.classes.emptyMessage),options:$("<div/>").addClass(this.classes.container),panes:$("<div/>").addClass(this.classes.container),title:$("<div/>").addClass(this.classes.title),titleRow:$("<div/>").addClass(this.classes.titleRow),wrapper:$("<div/>")};this.s={colOpts:[],dt:f,filterPane:-1,panes:[],selectionList:[],updating:false};f.settings()[0]._searchPanes=this;this.dom.clearAll.text(f.i18n("searchPanes.clearMessage","Clear All"));this._getState();if(this.s.dt.settings()[0]._bInitComplete||j){this._paneDeclare(f,h,g)}else{f.on("preInit.dt",function(){i._paneDeclare(f,h,g)})}}e.prototype.clearSelections=function(){var g=this.dom.container.find(this.classes.search);g.each(function(){$(this).val("");$(this).trigger("input")});var i=[];for(var h=0,f=this.s.panes;h<f.length;h++){var j=f[h];if(j.s.dtPane!==undefined){i.push(j.clearPane())}}this.s.dt.draw();return i};e.prototype.getNode=function(){return this.dom.container};e.prototype.rebuild=function(h){if(h===void 0){h=false}$(this.dom.emptyMessage).remove();var i=[];this.clearSelections();for(var g=0,f=this.s.panes;g<f.length;g++){var j=f[g];if(h!==false&&j.s.index!==h){continue}j.clearData();i.push(j.rebuildPane())}this._updateFilterCount();this._attachPaneContainer();if(i.length===1){return i[0]}else{return i}};e.prototype.redrawPanes=function(){var G=this.s.dt;if(!this.s.updating){var h=true;var C=this.s.filterPane;if(G.rows({search:"applied"}).data().toArray().length===G.rows().data().toArray().length){h=false}else{if(this.c.viewTotal){for(var m=0,x=this.s.panes;m<x.length;m++){var B=x[m];if(B.s.dtPane!==undefined){var A=B.s.dtPane.rows({selected:true}).data().toArray().length;if(A>0&&C===-1){C=B.s.index}else{if(A>0){C=null}}}}}}var z=void 0;var F=[];if(!this.regenerating){for(var w=0,v=this.s.panes;w<v.length;w++){var B=v[w];if(B.s.selectPresent){this.s.selectionList.push({index:B.s.index,rows:B.s.dtPane.rows({selected:true}).data().toArray(),protect:false});G.state.save();break}else{if(B.s.deselect){z=B.s.index;var p=B.s.dtPane.rows({selected:true}).data().toArray();if(p.length>0){this.s.selectionList.push({index:B.s.index,rows:p,protect:true})}}}}if(this.s.selectionList.length>0){var y=this.s.selectionList[this.s.selectionList.length-1].index;for(var u=0,t=this.s.panes;u<t.length;u++){var B=t[u];B.s.lastSelect=(B.s.index===y&&this.s.selectionList.length===1)}}for(var E=0;E<this.s.selectionList.length;E++){if(this.s.selectionList[E].index!==z||this.s.selectionList[E].protect===true){var H=false;for(var D=E+1;D<this.s.selectionList.length;D++){if(this.s.selectionList[D].index===this.s.selectionList[E].index){H=true}}if(!H){F.push(this.s.selectionList[E]);this.s.selectionList[E].protect=false}}}for(var r=0,q=this.s.panes;r<q.length;r++){var B=q[r];if(B.s.dtPane!==undefined){var o=true;B.s.filteringActive=true;if((C!==-1&&C!==null&&C===B.s.index)||h===false){o=false;B.s.filteringActive=false}B.updatePane(!o?false:h)}}this._updateFilterCount();if(F.length>0&&F.length<this.s.selectionList.length){this._cascadeRegen(F);var y=F[F.length-1].index;for(var n=0,l=this.s.panes;n<l.length;n++){var B=l[n];B.s.lastSelect=(B.s.index===y&&this.s.selectionList.length===1)}}else{if(F.length>0){for(var k=0,g=this.s.panes;k<g.length;k++){var s=g[k];if(s.s.dtPane!==undefined){var o=true;s.s.filteringActive=true;if((C!==-1&&C!==null&&C===s.s.index)||h===false){o=false;s.s.filteringActive=false}s.updatePane(!o?o:h)}}}}}else{for(var f=0,I=this.s.panes;f<I.length;f++){var B=I[f];if(B.s.dtPane!==undefined){var o=true;B.s.filteringActive=true;if((C!==-1&&C!==null&&C===B.s.index)||h===false){o=false;B.s.filteringActive=false}B.updatePane(!o?o:h)}}this._updateFilterCount()}if(!h){this.s.selectionList=[]}}};e.prototype._attach=function(){$(this.dom.container).removeClass(this.classes.hide);$(this.dom.titleRow).removeClass(this.classes.hide);$(this.dom.titleRow).remove();$(this.dom.title).appendTo(this.dom.titleRow);if(this.c.clear){$(this.dom.clearAll).appendTo(this.dom.titleRow)}$(this.dom.titleRow).appendTo(this.dom.container);for(var g=0,f=this.s.panes;g<f.length;g++){var h=f[g];$(h.dom.container).appendTo(this.dom.panes)}$(this.dom.panes).appendTo(this.dom.container);if($("div."+this.classes.container).length===0){$(this.dom.container).prependTo(this.s.dt)}return this.dom.container};e.prototype._attachExtras=function(){$(this.dom.container).removeClass(this.classes.hide);$(this.dom.titleRow).removeClass(this.classes.hide);$(this.dom.titleRow).remove();$(this.dom.title).appendTo(this.dom.titleRow);if(this.c.clear){$(this.dom.clearAll).appendTo(this.dom.titleRow)}$(this.dom.titleRow).appendTo(this.dom.container);return this.dom.container};e.prototype._attachMessage=function(){var g;try{g=this.s.dt.i18n("searchPanes.emptyPanes","No SearchPanes")}catch(f){g=null}if(g===null){$(this.dom.container).addClass(this.classes.hide);$(this.dom.titleRow).removeClass(this.classes.hide);return}else{$(this.dom.container).removeClass(this.classes.hide);$(this.dom.titleRow).addClass(this.classes.hide)}$(this.dom.emptyMessage).text(g);this.dom.emptyMessage.appendTo(this.dom.container);return this.dom.container};e.prototype._attachPaneContainer=function(){for(var g=0,f=this.s.panes;g<f.length;g++){var h=f[g];if(h.s.displayed===true){return this._attach()}}return this._attachMessage()};e.prototype._cascadeRegen=function(g){this.regenerating=true;var k=-1;if(g.length===1){k=g[0].index}for(var j=0,i=this.s.panes;j<i.length;j++){var l=i[j];l.setCascadeRegen(true);l.setClear(true);if((l.s.dtPane!==undefined&&l.s.index===k)||l.s.dtPane!==undefined){l.clearPane()}l.setClear(false)}this._makeCascadeSelections(g);this.s.selectionList=g;for(var h=0,f=this.s.panes;h<f.length;h++){var l=f[h];l.setCascadeRegen(false)}this.regenerating=false};e.prototype._checkMessage=function(){for(var g=0,f=this.s.panes;g<f.length;g++){var h=f[g];if(h.s.displayed===true){return}}return this._attachMessage()};e.prototype._getState=function(){var f=this.s.dt.state.loaded();if(f&&f.searchPanes&&f.searchPanes.selectionList!==undefined){this.s.selectionList=f.searchPanes.selectionList}};e.prototype._makeCascadeSelections=function(f){for(var i=0,j=f;i<j.length;i++){var m=j[i];var g=function(s){if(s.s.index===m.index&&s.s.dtPane!==undefined){if(s.s.dtPane.rows({selected:true}).data().toArray().length>0&&s.s.dtPane!==undefined){s.setClear(true);s.clearPane();s.setClear(false)}var r=function(t){s.s.dtPane.rows().every(function(u){if(s.s.dtPane.row(u).data().filter===t.filter){s.s.dtPane.row(u).select()}})};for(var p=0,o=m.rows;p<o.length;p++){var q=o[p];r(q)}n._updateFilterCount()}};var n=this;for(var l=0,k=this.s.panes;l<k.length;l++){var h=k[l];g(h)}}this.s.dt.state.save()};e.prototype._paneDeclare=function(j,k,h){var n=this;j.columns(this.c.columns.length>0?this.c.columns:undefined).eq(0).each(function(i){n.s.panes.push(new a(k,h,i,n.c.layout,n.dom.panes))});var f=j.columns().eq(0).toArray().length;var m=this.c.panes.length;for(var g=0;g<m;g++){var l=f+g;this.s.panes.push(new a(k,h,l,this.c.layout,this.dom.panes,this.c.panes[g]))}if(this.s.dt.settings()[0]._bInitComplete){this._paneStartup(j)}else{this.s.dt.settings()[0].aoInitComplete.push({fn:function(){n._paneStartup(j)}})}};e.prototype._paneStartup=function(f){var g=this;if(this.s.dt.page.info().recordsTotal<=500){this._startup(f)}else{setTimeout(function(){g._startup(f)},100)}};e.prototype._startup=function(g){var j=this;$(this.dom.container).text("");this._attachExtras();$(this.dom.container).append(this.dom.panes);for(var h=0,f=this.s.panes;h<f.length;h++){var i=f[h];i.rebuildPane()}this._updateFilterCount();this._checkMessage();g.on("draw.dtsps",function(){j._updateFilterCount();if(j.c.cascadePanes||j.c.viewTotal){j.redrawPanes()}j.s.filterPane=-1});this.s.dt.on("stateSaveParams.dtsp",function(m,k,l){if(l.searchPanes===undefined){l.searchPanes={}}l.searchPanes.selectionList=j.s.selectionList});if(this.s.selectionList.length>0&&this.c.cascadePanes){this._cascadeRegen(this.s.selectionList)}g.columns(this.c.columns.length>0?this.c.columns:undefined).eq(0).each(function(k){if(j.s.panes[k]!==undefined&&j.s.panes[k].s.dtPane!==undefined&&j.s.panes[k].s.colOpts.preSelect!==undefined){var m=j.s.panes[k].s.dtPane.rows().data().toArray().length;for(var l=0;l<m;l++){if(j.s.panes[k].s.colOpts.preSelect.indexOf(j.s.panes[k].s.dtPane.cell(l,0).data())!==-1){j.s.panes[k].s.dtPane.row(l).select();j.s.panes[k].updateTable()}}}});this._updateFilterCount();g.on("destroy.dtsps",function(){for(var l=0,k=j.s.panes;l<k.length;l++){var m=k[l];m.destroy()}g.off(".dtsps");$(j.dom.clearAll).off(".dtsps");$(j.dom.container).remove();j.clearSelections()});if(this.c.clear){$(this.dom.clearAll).on("click.dtsps",function(){j.clearSelections()})}g.settings()[0]._searchPanes=this};e.prototype._updateFilterCount=function(){var i=0;for(var h=0,f=this.s.panes;h<f.length;h++){var j=f[h];if(j.s.dtPane!==undefined){i+=j.getPaneCount()}}var g=this.s.dt.i18n("searchPanes.title","Filters Active - %d",i);$(this.dom.title).text(g)};e.version="1.0.1";e.classes={clear:"dtsp-clear",clearAll:"dtsp-clearAll",container:"dtsp-searchPanes",emptyMessage:"dtsp-emptyMessage",hide:"dtsp-hidden",panes:"dtsp-panesContainer",search:"dtsp-search",title:"dtsp-title",titleRow:"dtsp-titleRow"};e.defaults={cascadePanes:false,clear:true,container:function(f){return f.table().container()},columns:[],layout:"columns-3",panes:[],viewTotal:false};return e}());
/*! SearchPanes 1.0.1
     * 2019-2020 SpryMedia Ltd - datatables.net/license
     */
(function(e){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(f){return e(f,window,document)})}else{if(typeof exports==="object"){module.exports=function(f,g){if(!f){f=window}if(!g||!g.fn.dataTable){g=require("datatables.net")(f,g).$}return e(g,f,f.document)}}else{e(window.jQuery,window,document)}}}(function(j,f,e){var i=j.fn.dataTable;j.fn.dataTable.SearchPanes=d;j.fn.DataTable.SearchPanes=d;j.fn.dataTable.SearchPane=a;j.fn.DataTable.SearchPane=a;i.Api.register("searchPanes.rebuild()",function(){return this.iterator("table",function(){if(this.searchPanes){this.searchPanes.rebuild()}})});i.Api.register("column().paneOptions()",function(k){return this.iterator("column",function(l){var m=this.aoColumns[l];if(!m.searchPanes){m.searchPanes={}}m.searchPanes.values=k;if(this.searchPanes){this.searchPanes.rebuild()}})});var h=j.fn.dataTable.Api.register;h("searchPanes()",function(){return this});h("searchPanes.clearSelections()",function(){var k=this.context[0];k._searchPanes.clearSelections();return this});h("searchPanes.rebuildPane()",function(l){var k=this.context[0];k._searchPanes.rebuild(l);return this});h("searchPanes.container()",function(){var k=this.context[0];return k._searchPanes.getNode()});j.fn.dataTable.ext.buttons.searchPanesClear={text:"Clear Panes",action:function(n,m,l,k){m.searchPanes.clearSelections()}};j.fn.dataTable.ext.buttons.searchPanes={text:"Search Panes",init:function(o,n,k){var l=new j.fn.dataTable.SearchPanes(o,{filterChanged:function(p){o.button(n).text(o.i18n("searchPanes.collapse",{0:"SearchPanes",_:"SearchPanes (%d)"},p))}});var m=o.i18n("searchPanes.collapse","SearchPanes");o.button(n).text(m);k._panes=l},action:function(n,m,l,k){n.stopPropagation();this.popover(k._panes.getNode(),{align:"dt-container"});k._panes.adjust()}};function g(n,k){if(k===void 0){k=false}var m=new i.Api(n);var p=m.init().searchPanes||i.defaults.searchPanes;var l=new d(m,p,k);var o=l.getNode();return o}j(e).on("preInit.dt.dtsp",function(m,l,k){if(m.namespace!=="dt"){return}if(l.oInit.searchPanes||i.defaults.searchPanes){if(!l._searchPanes){g(l,true)}}});i.ext.feature.push({cFeature:"P",fnInit:g});if(i.ext.features){i.ext.features.register("searchPanes",g)}}))}());