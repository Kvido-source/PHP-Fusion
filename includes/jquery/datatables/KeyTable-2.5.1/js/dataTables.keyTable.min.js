/*! KeyTable 2.5.1
 * Â©2009-2019 SpryMedia Ltd - datatables.net/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("datatables.net")(b,c).$}return a(c,b,b.document)}}else{a(jQuery,window,document)}}}(function(e,c,b,g){var d=e.fn.dataTable;var a=0;var f=function(k,j){if(!d.versionCheck||!d.versionCheck("1.10.8")){throw"KeyTable requires DataTables 1.10.8 or newer"}this.c=e.extend(true,{},d.defaults.keyTable,f.defaults,j);this.s={dt:new d.Api(k),enable:true,focusDraw:false,waitingForDraw:false,lastFocus:null,namespace:".keyTable-"+(a++)};this.dom={};var i=this.s.dt.settings()[0];var h=i.keytable;if(h){return h}i.keytable=this;this._constructor()};e.extend(f.prototype,{blur:function(){this._blur()},enable:function(h){this.s.enable=h},focus:function(i,h){this._focus(this.s.dt.cell(i,h))},focused:function(h){var j=this.s.lastFocus;if(!j){return false}var i=this.s.lastFocus.cell.index();return h.row===i.row&&h.column===i.column},_constructor:function(){this._tabInput();var m=this;var l=this.s.dt;var k=e(l.table().node());var j=this.s.namespace;var h=false;if(k.css("position")==="static"){k.css("position","relative")}e(l.table().body()).on("click"+j,"th, td",function(p){if(m.s.enable===false){return}var o=l.cell(this);if(!o.any()){return}m._focus(o,null,false,p)});e(b).on("keydown"+j,function(o){if(!h){m._key(o)}});if(this.c.blurable){e(b).on("mousedown"+j,function(o){if(e(o.target).parents(".dataTables_filter").length){m._blur()}if(e(o.target).parents().filter(l.table().container()).length){return}if(e(o.target).parents("div.DTE").length){return}if(e(o.target).parents("div.editor-datetime").length){return}if(e(o.target).parents().filter(".DTFC_Cloned").length){return}m._blur()})}if(this.c.editor){var i=this.c.editor;i.on("open.keyTableMain",function(p,q,o){if(q!=="inline"&&m.s.enable){m.enable(false);i.one("close"+j,function(){m.enable(true)})}});if(this.c.editOnFocus){l.on("key-focus"+j+" key-refocus"+j,function(q,p,o,r){m._editor(null,r,true)})}l.on("key"+j,function(r,q,p,o,s){m._editor(p,s,false)});e(l.table().body()).on("dblclick"+j,"th, td",function(p){if(m.s.enable===false){return}var o=l.cell(this);if(!o.any()){return}m._editor(null,p,true)});i.on("preSubmit",function(){h=true}).on("preSubmitCancelled",function(){h=false}).on("submitComplete",function(){h=false})}if(l.settings()[0].oFeatures.bStateSave){l.on("stateSaveParams"+j,function(p,o,q){q.keyTable=m.s.lastFocus?m.s.lastFocus.cell.index():null})}l.on("draw"+j,function(r){if(m.s.focusDraw){return}var q=m.s.lastFocus;if(q&&q.node&&e(q.node).closest("body")===b.body){var o=m.s.lastFocus.relative;var p=l.page.info();var s=o.row+p.start;if(p.recordsDisplay===0){return}if(s>=p.recordsDisplay){s=p.recordsDisplay-1}m._focus(s,o.column,true,r)}});if(this.c.clipboard){this._clipboard()}l.on("destroy"+j,function(){m._blur(true);l.off(j);e(l.table().body()).off("click"+j,"th, td").off("dblclick"+j,"th, td");e(b).off("mousedown"+j).off("keydown"+j).off("copy"+j).off("paste"+j)});var n=l.state.loaded();if(n&&n.keyTable){l.one("init",function(){var o=l.cell(n.keyTable);if(o.any()){o.focus()}})}else{if(this.c.focus){l.cell(this.c.focus).focus()}}},_blur:function(i){if(!this.s.enable||!this.s.lastFocus){return}var h=this.s.lastFocus.cell;e(h.node()).removeClass(this.c.className);this.s.lastFocus=null;if(!i){this._updateFixedColumns(h.index().column);this._emitEvent("key-blur",[this.s.dt,h])}},_clipboard:function(){var j=this.s.dt;var i=this;var h=this.s.namespace;if(!c.getSelection){return}e(b).on("copy"+h,function(k){var n=k.originalEvent;var l=c.getSelection().toString();var m=i.s.lastFocus;if(!l&&m){n.clipboardData.setData("text/plain",m.cell.render(i.c.clipboardOrthogonal));n.preventDefault()}});e(b).on("paste"+h,function(l){var o=l.originalEvent;var n=i.s.lastFocus;var p=b.activeElement;var m=i.c.editor;var k;if(n&&(!p||p.nodeName.toLowerCase()==="body")){o.preventDefault();if(c.clipboardData&&c.clipboardData.getData){k=c.clipboardData.getData("Text")}else{if(o.clipboardData&&o.clipboardData.getData){k=o.clipboardData.getData("text/plain")}}if(m){m.inline(n.cell.index()).set(m.displayed()[0],k).submit()}else{n.cell.data(k);j.draw(false)}}})},_columns:function(){var j=this.s.dt;var h=j.columns(this.c.columns).indexes();var i=[];j.columns(":visible").every(function(k){if(h.indexOf(k)!==-1){i.push(k)}});return i},_editor:function(p,o,k){var m=this;var h=this.s.dt;var n=this.c.editor;var j=this.s.lastFocus.cell;var i=this.s.namespace;if(e("div.DTE",j.node()).length){return}if(p!==null&&((p>=0&&p<=9)||p===11||p===12||(p>=14&&p<=31)||(p>=112&&p<=123)||(p>=127&&p<=159))){return}o.stopPropagation();if(p===13){o.preventDefault()}var l=function(){n.one("open"+i,function(){n.off("cancelOpen"+i);if(!k){e("div.DTE_Field_InputControl input, div.DTE_Field_InputControl textarea").select()}h.keys.enable(k?"tab-only":"navigation-only");h.on("key-blur.editor",function(s,r,q){if(n.displayed()&&q.node()===j.node()){n.submit()}});if(k){e(h.table().container()).addClass("dtk-focus-alt")}n.on("preSubmitCancelled"+i,function(){setTimeout(function(){m._focus(j,null,false)},50)});n.on("submitUnsuccessful"+i,function(){m._focus(j,null,false)});n.one("close",function(){h.keys.enable(true);h.off("key-blur.editor");n.off(i);e(h.table().container()).removeClass("dtk-focus-alt")})}).one("cancelOpen"+i,function(){n.off(i)}).inline(j.index())};if(p===13){k=true;e(b).one("keyup",function(){l()})}else{l()}},_emitEvent:function(i,h){this.s.dt.iterator("table",function(j,k){e(j.nTable).triggerHandler(i,h)})},_focus:function(u,l,j,h){var n=this;var i=this.s.dt;var r=i.page.info();var t=this.s.lastFocus;if(!h){h=null}if(!this.s.enable){return}if(typeof u!=="number"){if(!u.any()){return}var m=u.index();l=m.column;u=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(m.row);if(u<0){return}if(r.serverSide){u+=r.start}}if(r.length!==-1&&(u<r.start||u>=r.start+r.length)){this.s.focusDraw=true;this.s.waitingForDraw=true;i.one("draw",function(){n.s.focusDraw=false;n.s.waitingForDraw=false;n._focus(u,l,g,h)}).page(Math.floor(u/r.length)).draw(false);return}if(e.inArray(l,this._columns())===-1){return}if(r.serverSide){u-=r.start}var s=i.cells(null,l,{search:"applied",order:"applied"}).flatten();var q=i.cell(s[u]);if(t){if(t.node===q.node()){this._emitEvent("key-refocus",[this.s.dt,q,h||null]);return}this._blur()}this._removeOtherFocus();var k=e(q.node());k.addClass(this.c.className);this._updateFixedColumns(l);if(j===g||j===true){this._scroll(e(c),e(b.body),k,"offset");var p=i.table().body().parentNode;if(p!==i.table().header().parentNode){var o=e(p.parentNode);this._scroll(o,o,k,"position")}}this.s.lastFocus={cell:q,node:q.node(),relative:{row:i.rows({page:"current"}).indexes().indexOf(q.index().row),column:q.index().column}};this._emitEvent("key-focus",[this.s.dt,q,h||null]);i.state.save()},_key:function(n){if(this.s.waitingForDraw){n.preventDefault();return}var k=this.s.enable;var o=k===true||k==="navigation-only";if(!k){return}if((n.keyCode===0||n.ctrlKey||n.metaKey||n.altKey)&&!(n.ctrlKey&&n.altKey)){return}var p=this.s.lastFocus;if(!p){return}if(!this.s.dt.cell(p.node).any()){this.s.lastFocus=null;return}var m=this;var h=this.s.dt;var j=this.s.dt.settings()[0].oScroll.sY?true:false;if(this.c.keys&&e.inArray(n.keyCode,this.c.keys)===-1){return}switch(n.keyCode){case 9:this._shift(n,n.shiftKey?"left":"right",true);break;case 27:if(this.s.blurable&&k===true){this._blur()}break;case 33:case 34:if(o&&!j){n.preventDefault();h.page(n.keyCode===33?"previous":"next").draw(false)}break;case 35:case 36:if(o){n.preventDefault();var l=h.cells({page:"current"}).indexes();var i=this._columns();this._focus(h.cell(l[n.keyCode===35?l.length-1:i[0]]),null,true,n)}break;case 37:if(o){this._shift(n,"left")}break;case 38:if(o){this._shift(n,"up")}break;case 39:if(o){this._shift(n,"right")}break;case 40:if(o){this._shift(n,"down")}break;case 113:if(this.c.editor){this._editor(null,n,true);break}default:if(k===true){this._emitEvent("key",[h,n.keyCode,this.s.lastFocus.cell,n])}break}},_removeOtherFocus:function(){var h=this.s.dt.table().node();e.fn.dataTable.tables({api:true}).iterator("table",function(i){if(this.table().node()!==h){this.cell.blur()}})},_scroll:function(h,m,o,q){var l=o[q]();var p=o.outerHeight();var i=o.outerWidth();var j=m.scrollTop();var k=m.scrollLeft();var r=h.height();var n=h.width();if(q==="position"){l.top+=parseInt(o.closest("table").css("top"),10)}if(l.top<j){m.scrollTop(l.top)}if(l.left<k){m.scrollLeft(l.left)}if(l.top+p>j+r&&p<r){m.scrollTop(l.top+p-r)}if(l.left+i>k+n&&i<n){m.scrollLeft(l.left+i-n)}},_shift:function(m,p,n){var l=this;var h=this.s.dt;var q=h.page.info();var t=q.recordsDisplay;var o=this.s.lastFocus.cell;var k=this._columns();if(!o){return}var s=h.rows({filter:"applied",order:"applied"}).indexes().indexOf(o.index().row);if(q.serverSide){s+=q.start}var i=h.columns(k).indexes().indexOf(o.index().column);var r=s,j=k[i];if(p==="right"){if(i>=k.length-1){r++;j=k[0]}else{j=k[i+1]}}else{if(p==="left"){if(i===0){r--;j=k[k.length-1]}else{j=k[i-1]}}else{if(p==="up"){r--}else{if(p==="down"){r++}}}}if(r>=0&&r<t&&e.inArray(j,k)!==-1){if(m){m.preventDefault()}this._focus(r,j,true,m)}else{if(!n||!this.c.blurable){if(m){m.preventDefault()}}else{this._blur()}}},_tabInput:function(){var j=this;var i=this.s.dt;var h=this.c.tabIndex!==null?this.c.tabIndex:i.settings()[0].iTabIndex;if(h==-1){return}var k=e('<div><input type="text" tabindex="'+h+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(i.table().node());k.children().on("focus",function(m){var l=i.cell(":eq(0)",j._columns(),{page:"current"});if(l.any()){j._focus(l,null,true,m)}})},_updateFixedColumns:function(j){var k=this.s.dt;var i=k.settings()[0];if(i._oFixedColumns){var l=i._oFixedColumns.s.iLeftColumns;var h=i.aoColumns.length-i._oFixedColumns.s.iRightColumns;if(j<l||j>=h){k.fixedColumns().update()}}}});f.defaults={blurable:true,className:"focus",clipboard:true,clipboardOrthogonal:"display",columns:"",editor:null,editOnFocus:false,focus:null,keys:null,tabIndex:null};f.version="2.5.1";e.fn.dataTable.KeyTable=f;e.fn.DataTable.KeyTable=f;d.Api.register("cell.blur()",function(){return this.iterator("table",function(h){if(h.keytable){h.keytable.blur()}})});d.Api.register("cell().focus()",function(){return this.iterator("cell",function(h,j,i){if(h.keytable){h.keytable.focus(j,i)}})});d.Api.register("keys.disable()",function(){return this.iterator("table",function(h){if(h.keytable){h.keytable.enable(false)}})});d.Api.register("keys.enable()",function(h){return this.iterator("table",function(i){if(i.keytable){i.keytable.enable(h===g?true:h)}})});d.Api.register("keys.move()",function(h){return this.iterator("table",function(i){if(i.keytable){i.keytable._shift(null,h,false)}})});d.ext.selector.cell.push(function(m,n,k){var o=n.focused;var p=m.keytable;var j=[];if(!p||o===g){return k}for(var l=0,h=k.length;l<h;l++){if((o===true&&p.focused(k[l]))||(o===false&&!p.focused(k[l]))){j.push(k[l])}}return j});e(b).on("preInit.dt.dtk",function(l,i,h){if(l.namespace!=="dt"){return}var m=i.oInit.keys;var k=d.defaults.keys;if(m||k){var j=e.extend({},k,m);if(m!==false){new f(i,j)}}});return f}));